CREATE OR REPLACE FUNCTION BIFROSTTEST.PUBLIC.PERIOD_UDF(D1 TIMESTAMP_NTZ(9), D2 TIMESTAMP_NTZ(9), PRECISIONDIGITS NUMBER(38,0))
RETURNS VARCHAR(16777216)
LANGUAGE SQL
IMMUTABLE
AS 
$$
CASE WHEN PRECISIONDIGITS <= 0 THEN
        TO_VARCHAR(D1, 'YYYY-MM-DD HH24:MI:SS') || '*' || TO_VARCHAR(D2, 'YYYY-MM-DD HH24:MI:SS')
     WHEN PRECISIONDIGITS > 9 THEN
        TO_VARCHAR(D1, 'YYYY-MM-DD HH24:MI:SS.FF9') || '*' || TO_VARCHAR(D2, 'YYYY-MM-DD HH24:MI:SS.FF9')
     ELSE
        TO_VARCHAR(D1, 'YYYY-MM-DD HH24:MI:SS.FF' || PRECISIONDIGITS) || '*' || TO_VARCHAR(D2, 'YYYY-MM-DD HH24:MI:SS.FF' || PRECISIONDIGITS)
END
$$;
